# Installing R Packages

There are a couple of ways we can install R packages in a Docker image, each with their pros and cons. Let's explore all of them in this section.

Method              | Details                                                                                                                              | Pros                                                                                                                | Cons
--------------------|--------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------
`install2.r`        | Install R packages using a [littler](https://github.com/eddelbuettel/littler/blob/master/inst/examples/install2.r) script from CRAN. | <ul><li>Easy to use in `RUN` commands. </li><li>Well [documented](https://eddelbuettel.github.io/littler/)</li></ul> | <ul><li>Requires `{littler}` pre-installed. </li><li>Default CRAN repo does not ensure full reproducibility.</li><li>Packages are compiled from sources - high Docker build time</li></ul>
MRAN                | Install R packages from [MRAN repository](https://mran.microsoft.com). |<ul><li>MRAN date-lock ensure full reproducibility at any time in the future</li><li>No dependencies on other R packages</li></ul>| <ul><li>Depend on Microsoft keeping MRAN alive</li><li>Can't lock down specific versions of R package</li><li>Packages are compiled from sources - high Docker build time</li></ul>
[`{renv}`](https://rstudio.github.io/renv/index.html) Approach 1 | Install packages when Docker image is built. | <ul><li>`{renv}` is an easy to use dependency management tool with a human-readable `renv.lock` file.</li><li>Ensures full reproduciblity. Locks package versions.</li><li>Once image is built, no external dependencies.</li><li>Binaries are prefered, reducing Docker build times significantly</li><li>Deployment to CI/CD frameworks is easier</li></ul>  | <ul><li>Modifications to `{renv}` will require rebuilding the image.</li></ul>
[`{renv}`](https://rstudio.github.io/renv/index.html) Approach 2 | Install packages when Docker container is run. | <ul><li>Using a local shared cache can _highly speed up_ the Docker build process across all Docker builds</li><li>Binaries are prefered, reducing Docker build times significantly</li></ul> | <ul><li>Requires you to modify how containers are created</li><li>Requires a bit of extra orchestration in how containers are launched</li><li>Deployment in CI/CD frameworks requires extra orchestration</li></ul>


[1] Useful reading for `{renv}` with Docker - [link](https://rstudio.github.io/renv/articles/docker.html)
